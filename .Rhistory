ddply(.,~week~variable,colwise(mean, is.numeric)) %>%
dcast(variable~week)
View(W1)
W1 <- A1 %>%
melt(., id.vars = c("Date","week")) %>%
filter(!is.na(value)) %>%
ddply(.,~week~variable,colwise(mean, is.numeric))
View(W2)
W2 <- W1 %>%
dcast(variable~week) %>%
select(-variable,일,월,화,수,목,금,토)
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토)
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토) %>%
t
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토) %>%
t %>%
`colnames<-`(paste0("id",1:22))
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토) %>%
t
str(W2)
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토) %>%
t %>%
as_tibble
str(W2)
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토) %>%
t
W2 <- W1 %>%
dcast(variable~week) %>%
select(일,월,화,수,목,금,토)
View(W2)
W2 <- W1 %>%
dcast(variable~week) %>%
select(variable,일,월,화,수,목,금,토)
View(A1)
D1 %>%
ggplot() +
geom_point(aes(x=Date,y=value,
color = variable)) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
A1 %>%
ggplot() +
geom_point(aes(x=Date,y=value,
color = variable)) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
View(W1)
View(A1)
D1 <- A1 %>%
melt(.,id.vars = c("Date","week"))
View(D1)
D1 <- A1 %>%
melt(.,id.vars = "Date")
D1 %>%
ggplot() +
geom_point(aes(x=Date,y=value,
color = variable)) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
D1 <- A1 %>%
melt(-week,id.vars = "Date")
D1 <- A1[,-"week"] %>%
melt(,id.vars = "Date")
D1 <- A1[,-"week"] %>%
melt(.,id.vars = "Date")
D1 <- A1[,25] %>%
melt(.,id.vars = "Date")
D1 <- A1[,-24] %>%
melt(.,id.vars = "Date")
D1 %>%
ggplot() +
geom_point(aes(x=Date,y=value,
color = variable)) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
D1 <- A1[,-24] %>%
melt(.,id.vars = "Date") %>%
na.omit
D1 %>%
ggplot() +
geom_point(aes(x=Date,y=value,
color = variable)) +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor.y = element_blank(),
axis.title.x=element_blank(),
axis.text.x = element_blank(),
axis.ticks = element_blank())
D1 %>%
ggplot() +
geom_boxplot(aes(x=variable,y=value,
color = variable))
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value,
color = variable))
W1 %>%
ggplot() +
geom_boxplot(aes(x=week,y=valuee))
W1 %>%
ggplot() +
geom_boxplot(aes(x=week,y=value))
View(W1)
W1 %>%
ggplot() +
geom_boxplot(aes(x=week,y=value)) +
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일"))
W1 %>%
ggplot() +
geom_point(aes(x=week,
y=value))
W1 %>%
ggplot() +
geom_boxplot(aes(x=week,y=value)) +
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일"))
View(W2)
W1 %>%
mean(.$value)
W1 %>%
mean(.$value,na.rm = T)
mean(W1$value)
All_AVG <- mean(W1$value)
W1 %>%
ggplot() +
geom_boxplot(aes(x=week,y=value)) +
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일")) +
geom_abline(intercept=All_AVG, slope=0, colour="red", size=0.5)
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
print(result)
}
View(A2)
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value)) +
stat_smooth(method = lm, se = TRUE, color = "red")
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value)) +
stat_smooth()
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value))
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value,color=variable)) +
stat_smooth()
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value,color=variable))
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value))
W1 %>%
ggplot() +
geom_jitter(aes(x=week,y=value))
W1 %>%
ggplot() +
geom_jitter(aes(x=week,y=value))+
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일"))
W1 %>%
ggplot() +
geom_jitter(aes(x=week,y=value))+
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일")) +
stat_smooth(method = lm, se = TRUE, color = "red")
W1 %>%
ggplot() +
geom_point(aes(x=week,y=value))+
scale_x_discrete(limits = c("월", "화", "수","목","금","토","일")) +
stat_smooth(method = lm, se = TRUE, color = "red")
W2 <- W1 %>%
dcast(variable~week) %>%
select(월,화,수,목,금,토,일)
lmw <- lm(X~Y,W2)
#cor.test
getcor <- function() {
dataframe <- NULL
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
print(result)
}
return(dataframe)
}
getcor
getcor()
#cor.test
function(){
COR <- data.frame(id = paste0("id",1:22),
correl = rep(0,22))
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
COR<- CorT(i)
COR
}
}
#cor.test
getcor <- function(){
COR <- data.frame(id = paste0("id",1:22),
correl = rep(0,22))
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
COR<- CorT(i)
COR
}
}
getcor()
#cor.test
function(){
COR <- data.frame(id = paste0("id",1:22),
correl = rep(0,22))
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result)
}
}
#cor.test
getcor <- function(){
COR <- data.frame(id = paste0("id",1:22),
correl = rep(0,22))
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result)
}
}
getcor()
COR <- getcor()
#cor.test
getcor <- function(){
assign(COR
for (i in 2:23) {
assign(COR,
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result))
#cor.test
getcor <- function(){
assign(COR,
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result))
#cor.test
getcor <- function(){
COR <- NULL
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result)
}
}
COR <- getcor()
#cor.test
getcor <- function(){
for (i in 2:23) {
COR <- NULL
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- print(result)
}
}
COR <- getcor()
getcor()
#cor.test
getcor <- function(){
for (i in 2:23) {
COR <- NULL
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
result <- CorT(i)
COR <- result
}
}
getcor()
saveCorrel <- numeric(22)
#cor.test
getcor <- function(){
saveCorrel <- numeric(22)
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <-CorT(i)
}
}
getcor()
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
CorT(i)
}
saveCorrel <- numeric(22)
#cor.test
getcor <- function(){
saveCorrel <- numeric(22)
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel <-print(CorT(i))
}
}
getcor()
saveCorrel <- getcor()
saveCorrel <- numeric(22)
for (i in 2:23) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a]), a]
B2 <- match(B1,A2[,a])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
saveCorrel
for (i in 1:22) {
CorT <- function(a+1){
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
#cor.test
getcor <- function(){
saveCorrel <- numeric(22)
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
}
getcor()
rm("saveCorrel")
getcor()
getcor()
#cor.test
getcor <- function(){
saveCorrel <- numeric(22)
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
}
getcor()
for (i in 1:22) {
saveCorrel <- numeric(22)
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
saveCorrel <- numeric(22) +
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
saveCorrel <- numeric(22) +
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
saveCorrel <- numeric(22)
for (i in 1:22) {
CorT <- function(a){
B1 <- A2[!is.na(A2[,a+1]), a+1]
B2 <- match(B1,A2[,a+1])
B3 <- A2[B2,25]
cor(B1,B3)
}
saveCorrel[i] <- CorT(i)
}
Correl <- data.frame(id = paste0("id",1:22),
value = saveCorrel)
View(Correl)
View(A2)
write.csv(Correl, "doc/Correl.csv")
View(A2)
