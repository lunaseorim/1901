coord_cartesian(xlim=c(126.75,127.22),
ylim=c(37.42,37.705)) +
scale_fill_gradient(low = '#90E4FF',high='#90E4FF',na.value = "white") +
theme_void()+
geom_point(aes(x = 경도, y = 위도,colour = Freq),
size = 15,alpha = 1, data = A4) +
scale_colour_gradient(high="#00A2C9" ,low="#00D8FF") +
annotate("text",x=A4$경도,y=A4$위도,label = plotlab,
size=3,color="white")
dev.off()
View(AA0)
write.csv(AA0,"../doc/rawdata.csv")
png("test.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group,fill = Freq),colour = "white",size=0.8,
show.legend = F) +
coord_cartesian(xlim=c(126.75,127.22),
ylim=c(37.42,37.705)) +
scale_fill_gradient(low = '#90E4FF',high='#90E4FF',na.value = "white") +
theme_void()+
geom_point(aes(x = 경도, y = 위도,colour = Freq),
size = 15,alpha = 1, data = A4) +
scale_colour_gradient(high="#00A2C9" ,low="#00D8FF") +
annotate("text",x=A4$경도,y=A4$위도,label = plotlab,
size=3,color="white")
dev.off()
png("test.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group,fill = Freq),colour = "white",size=0.8,
show.legend = F) +
coord_cartesian(xlim=c(126.75,127.22),
ylim=c(37.42,37.705)) +
scale_fill_gradient(low = '#B3AEFF',high='#B3AEFF',na.value = "white") +
theme_void()+
geom_point(aes(x = 경도, y = 위도,colour = Freq),
size = 15,alpha = 1, data = A4) +
scale_colour_gradient(high="#6B66FF" ,low="#8F8AFF") +
annotate("text",x=A4$경도,y=A4$위도,label = plotlab,
size=3,color="white")
dev.off()
B1 <- read.csv("../doc/관광경쟁력.csv")
View(B1)
ggplot() +
geom_bar(aes(x=구,y=종합지수),data = B1, stat = "identity")
ggplot() +
geom_bar(aes(x=구,y=종합지수),data = B1, stat = "identity") +
ylim(50,1.1*max(B1$종합지수))
max(B1$종합지수)
1.1*max(B1$종합지수)
ggplot() +
geom_bar(aes(x=구,y=종합지수),data = B1, stat = "identity") +
ylim(50,1.1*max(B1$종합지수))
ggplot() +
geom_bar(aes(x=구,y=종합지수),data = B1, stat = "identity") +
ylim(0,1.1*max(B1$종합지수))
str(B1)
ggplot(B1,aes(x=구,y=종합지수,fill=등급)) +
geom_bar(stat = "identity")
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity")
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
coord_flip()
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity")
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 0.8))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 1))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 5))
dev.off()
png("test11.png",width = 6.5, height = 4.9,
units = "in",res = 1200)
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 5))
dev.off()
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45,size = 5))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 5,hjust = 1)) +
dev.off()
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45,size = 5,hjust = 1))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 40,size = 5,hjust = 1))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 40,size = 5,hjust = 0.5))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 40,size = 5,hjust = 0.8))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8))
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8)) +
xlab("구")
png("test11.png",width = 6.5, height = 4.9,
units = "in",res = 1200)
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8)) +
xlab("구")
dev.off()
View(geocode_center)
View(getgeocode)
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(rgeos)
library(maptools)
library(raster)
library(readxl)
library(httr)
library(jsonlite)
setwd("R/")
#SET LOCALE ID
A3 <- read.csv("../doc/AA2.csv")
A3_1 <- data.frame(Var1 = NA,
Freq = NA,
id = 25:249)
A3 <- rbind(A3,A3_1)
A4 <- read.csv("../doc/AA2.csv")
seoul <- shapefile("../data/TL_SCCO_SIG.shp")
seoul <- spTransform(seoul,CRS("+proj=longlat"))
seoul_map <- fortify(seoul)
merge_result <- merge(A3,seoul_map,by="id")
getgeocode <- GET(url =
paste0("https://api.bigdatahub.co.kr/v1/datahub/datasets/search.json?pid=1000908",
"&$count=25"),
add_headers(TDCAccessKey='55c155bca4d4ec0e16d51838827125e3f5906f9846db003df03d5f7fd2a7edba'),
accept_json())
#SET GEOCODE_CENTER
getapi_data = fromJSON(content(getgeocode, "text"))
geocode_center <- getapi_data$entry[-1]
geocode_center$경도 <- as.numeric(geocode_center$경도)
geocode_center$위도 <- as.numeric(geocode_center$위도)
A4 <- merge(A4,geocode_center,by.x = "Var1",by.y="구")
View(A4)
#CIRCLE
plotlab <- paste0(A4$Var1,"\n",A4$Freq)
#png("test.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group,fill = Freq),colour = "white",size=0.8,
show.legend = F) +
coord_cartesian(xlim=c(126.75,127.22),
ylim=c(37.42,37.705)) +
scale_fill_gradient(low = '#B3AEFF',high='#B3AEFF',na.value = "white") +
theme_void()+
geom_point(aes(x = 경도, y = 위도,colour = Freq),
size = 15,alpha = 1, data = A4) +
scale_colour_gradient(high="#6B66FF" ,low="#8F8AFF") +
annotate("text",x=A4$경도,y=A4$위도,label = plotlab,
size=3,color="white")
B1 <- read.csv("../doc/관광경쟁력.csv")
#png("test11.png",width = 6.5, height = 4.9,
#    units = "in",res = 1200)
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8)) +
xlab("구")
dev.off()
#png("test11.png",width = 6.5, height = 4.9,
#    units = "in",res = 1200)
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8)) +
xlab("구")
B1 <- read.csv("../doc/관광경쟁력.csv")
View(B1)
plot(x = B1$종합지수,)
plot(x = B1$종합지수,y=B1$인구밀도.명...)
cor(x = B1$종합지수,y=B1$인구밀도.명...)
str(B1)
B1 <- read.csv("../doc/관광경쟁력.csv")
cor(x = B1$종합지수,y=B1$인구밀도.명...)
cor(x = B1$종합지수,y=B1$인구밀도)
plot(x = B1$종합지수,y=B1$인구밀도)
ggplot() %>%
geom_point(aes(x = 종합지수,y=인구밀도),
data = B1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도),
data = B1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1)
lm(종합지수~인구밀도,data = B1)
plot(종합지수~인구밀도,data = B1)
abline(lm(종합지수~인구밀도,data = B1), col = "blue", lty = 2)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(lm(종합지수~인구밀도,data = B1))
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(aes(lm(종합지수~인구밀도,data = B1)))
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm',formula=인구밀도~종합지수)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm',formula=종합지수~인구밀도)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm')
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm')
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm',formula = 종합지수~인구밀도)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm',se=F)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_smooth(method='lm',col = "red")
lm(종합지수~인구밀도,data = B1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 128.729626, slope = -0.001557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 128.729626, slope = -0.001557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -0.001557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -000.1557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -0.1557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -0.1557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -1.557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -15.57)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -1557)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -155.7)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 12872.9626, slope = -155.7)
plot(인구밀도~종합지수,data = B1)
abline(lm(인구밀도~종합지수,data = B1), col = "blue", lty = 2)
lm(인구밀도~종합지수,data = B1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 43371, slope = -255 )
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1) +
geom_abline(intercept = 43371, slope = -255 , col = "blue", lty = 2)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "blue", lty = 2)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "blue", lty = 2,size=2)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "blue", lty = 2,size=1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)")
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수")
cor.test(인구밀도~종합지수,data = B1)
cor.test(인구밀도,종합지수,data = B1)
cor.test(B1$인구밀도,B1$종합지수)
cor.test(B1$인구밀도,B1$종합지수,method = spearman)
cor.test(B1$인구밀도,B1$종합지수,method = "spearman")
cor.test(B1$인구밀도,B1$종합지수)
lm1 <- cor.test(B1$인구밀도,B1$종합지수)
lm1
View(lm1)
lm1 <- cor(B1$인구밀도,B1$종합지수)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301")
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 2)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 50)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 10)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 8)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7,col = "purple")
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7,col = "lightpurple")
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7,col = "purple")
png("test11.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7,col = "purple")
dev.off()
png("test11.png",width = 6.5, height = 4.9,
units = "in",res = 1200)
ggplot(B1,aes(x=reorder(구, -종합지수),y=종합지수,fill=등급)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 43,size = 5,hjust = 0.8)) +
xlab("구")
dev.off()
png("test12.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 7,col = "purple")
dev.off()
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 6,col = "purple")
png("test12.png",width = 6.5, height = 4.9,units = "in",res = 1200)
ggplot() +
geom_point(aes(x = 종합지수,y=인구밀도,colour = 등급),
data = B1,size = 2) +
geom_abline(intercept = 43371, slope = -255 ,
col = "purple", lty = 2,size=1) +
ylab("인구밀도(명/km^2)") +
xlab("관광경쟁력 종합지수") +
annotate("text",x=125,y=20000,label="cor = -0.6301",
size = 6,col = "purple")
dev.off()
dev.off()
AA <- NULL
for (i in 1:59) {
GTS0 <- GET(url = #paste0("http://korean.visitseoul.net/attractions",
"?curPage=",i),accept_json())
GTS1 <- fromJSON(content(GTS0,"text"))
AA <- rbind(AA,data.frame(place = GTS1$listVO$listObject$postSj,
adrs = GTS1$listVO$listObject$adres))
cat(i,"/59","\n",sep = "")
}
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(rgeos)
library(maptools)
library(raster)
library(readxl)
library(httr)
library(jsonlite)
knitr::opts_chunk$set(echo=T,message=F,warning=F,error = F)
for (i in 1:59) {
GTS0 <- GET(url = #paste0("http://korean.visitseoul.net/attractions",
"?curPage=",i),accept_json())
GTS1 <- fromJSON(content(GTS0,"text"))
AA <- rbind(AA,data.frame(place = GTS1$listVO$listObject$postSj,
adrs = GTS1$listVO$listObject$adres))
cat(i,"/59","\n",sep = "")
}
for (i in 1:59) {
GTS0 <- GET(url = paste0("http://korean.visitseoul.net/attractions",
"?curPage=",i),accept_json())
GTS1 <- fromJSON(content(GTS0,"text"))
AA <- rbind(AA,data.frame(place = GTS1$listVO$listObject$postSj,
adrs = GTS1$listVO$listObject$adres))
cat(i,"/59","\n",sep = "")
}
GTS_R <- read.csv("../doc/rawdata.csv")
View(GTS_R)
kableExtra::kable(head(GTS_R))
