T2 <- cumsum(T2) %>%
t() %>%
cbind(A1[,1:2],.)
T2 <- cumsum(T2)
str(T2)
T2 <- T1[3:54,]
T2 <- cumsum(T2)
T1 <- t(A1)
T2 <- as.data.frame.integer(T1[3:54,])
T2 <- as.data.frame(T1[3:54,])
T2 <- data.frame(T1[3:54,])
View(T2)
str(T2)
T2 <- as.numeric(data.frame(T1[3:54,]))
T2 <- as.integer(data.frame(T1[3:54,]))
A1 %>%
`colnames<-`("locate","id",1:52)
`colnames<-` c("locate","id",1:52)
`colnames<-` (c("locate","id",1:52))
A1 %>%
`colnames<-`(c("locate","id",1:52))
View(A1)
str(A1)
class(A1)
A1 <- read.csv("./doc/hong.csv")
View(A1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
A1 <- read.csv("./doc/hong.csv")
View(A1)
B1 <- t(A1)
View(B1)
class(B1)
B1_1 <-as.data.frame(B1)
View(B1_1)
B1_2 <- as.data.frame(B1[2:54,])
View(B1_2)
B1_2 <- as.data.frame(B1[3:54,])
class(B1_2)
C1 <- cumsum(B1_2)
str(B1_2)
str(A1)
str(B1)
c1 <- as.numeric(B1)
View(B1_2)
str(B1_1)
str(B1_2)
as.integer(B1_2)
class(B1_2)
D1 <- sapply(A1,cumsum)
class(A1)
str(A1)
D1 <- sapply(A1$X1주,cumsum)
j = 0
for (i in 3:52) {
JOT1 <- A[j+i,] + A[j+i+1,]
print(JOT1)
}
for (i in 3:52) {
JOT1 <- A1[j+i,] + A1[j+i+1,]
print(JOT1)
}
A1 <- read.csv("./doc/hong.csv")
T1 <- tapply(A1$X1주, A1$id, cumsum)
T1
T1 <- tapply(A1$X1주, cumsum)
T1 <- tapply(A1$id, A1$X1주, cumsum)
View(T1)
T1 <- revcumsum(A1)
T1 <- rev(A1)
View(T1)
T1 <- t(apply(apply(A1, 2, cumsum)), 1, cumsum))
T1 <- t(apply(apply(A1, 2, cumsum)), 1, cumsum)
AH <- read.csv("./doc/hongN.csv")
View(AH)
T1 <- t(apply(apply(AH, 2, cumsum)), 1, cumsum)
T1 <- t(apply(apply(A, 2, cumsum), 1, cumsum))
T1 <- t(apply(apply(AH, 2, cumsum), 1, cumsum))
View(AH)
View(T1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(raster)
library(rgeos)
library(maptools)
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea_map <- fortify(korea)
B1 <- rbind(A1$id,T1)
View(B1)
class(B1)
T1 <- t(apply(apply(AH, 2, cumsum), 1, cumsum))
B1 <- cbind(A1$id,T1)
View(B1)
str(B1)
merge_result <- merge(korea_map,B1,by='id')
View(B1)
C1 <- as.data.frame(B1)
View(C1)
colnames(C1,id)
colnames(C1,"id")
colnames(C1) <- c("id",1:52)
str(C1)
merge_result <- merge(korea_map,C1,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = 1)) +
geom_text(data = korea, aes(x = long, y = lat, label = 1))
p +
scale_fill_gradient(low = 'white',high='red')
View(merge_result)
colnames(C1) <- c("id",paste("주",1:52))
merge_result <- merge(korea_map,C1,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = 주1)) +
geom_text(data = korea, aes(x = long, y = lat, label = 주1))
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = 주1)) +
geom_text(data = korea, aes(x = long, y = lat, label = 주1))
p +
scale_fill_gradient(low = 'white',high='red')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = 주1)) +
geom_text(data = korea, aes(x = long, y = lat, label = 주1))
p +
scale_fill_gradient(low = 'white',high='red')
p
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = merge_result$`주 1`)) +
geom_text(data = korea, aes(x = long, y = lat, label = merge_result$`주 1`))
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = merge_result$`주 1`)) +
geom_text(data = korea, aes(x = long, y = lat, label = merge_result$`주 1`))
p
p +
scale_fill_gradient(low = 'white',high='red')
library("ggplot2", lib.loc="~/R/win-library/3.5")
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = merge_result$`주 1`)) +
geom_text(data = korea, aes(x = long, y = lat, label = merge_result$`주 1`))
p
str(C1
)
colnames(C1) <- c("id",paste("week",1:52))
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = week1)) +
geom_text(data = korea, aes(x = long, y = lat, label = week1))
p +
scale_fill_gradient(low = 'white',high='red')
C1$id <- C1$id -1
View(C1)
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea_map <- fortify(korea)
korea_map <- fortify(korea)
merge_result <- merge(korea_map,C1,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = week1)) +
geom_text(data = korea, aes(x = long, y = lat, label = week1))
p +
scale_fill_gradient(low = 'white',high='red')
C1$id
order(C1$id)
C1 <- C1[order(C1$id),]
View(C1)
str(C1)
merge_result <- merge(korea_map,C1,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = week1)) +
geom_text(data = korea, aes(x = long, y = lat, label = week1))
p +
scale_fill_gradient(low = 'white',high='red')
J1 <- C1[,1:2]
View(J1)
View(T1)
T1 <- t(apply(apply(AH, 2, cumsum), 1, cumsum))
T1 <- within(T1, acc_sum <- cumsum(count))
T1 <- t(apply(A1, 1, cumsum))
T1 <- t(apply(A1, 3, cumsum))
T1 <- t(apply(A1, 2, cumsum))
T1 <- t(A1)
T2 <- cumsum(T1)
str(T1)
T1 <- t(apply(A1[,-1],1,function(x)cumsum(x)))
str(T1)
A2 <- read.csv("./doc/hong.csv")
A2[,3:ncol(A1)] <- t(apply(df[,-1],1,function(x)cumsum(x)))
A2[,2:ncol(A1)] <- t(apply(df[,-1],1,function(x)cumsum(x)))
A2[,2:ncol(A1)] <- t(apply(A1[,-1],1,function(x)cumsum(x)))
View(A2)
str(A2)
A2$id <- A2$id - 1
View(A2)
merge_result <- merge(korea_map,A2,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = X1주)) +
geom_text(data = korea, aes(x = long, y = lat, label = X1주))
p +
scale_fill_gradient(low = 'white',high='red')
View(merge_result)
View(korea)
korea
A2 <- read.csv("./doc/hong.csv")
View(A2)
A2[,2:ncol(A1)] <- t(apply(A1[,-1],1,function(x)cumsum(x)))
A1 <- read.csv("./doc/hong.csv")
A2[,2:ncol(A1)] <- t(apply(A1[,-1],1,function(x)cumsum(x)))
A2$id <- c(0:6,8:16,7)
View(A2)
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea_map <- fortify(korea)
merge_result <- merge(korea_map,A2,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = X1주)) +
geom_text(data = korea, aes(x = long, y = lat, label = X1주))
p +
scale_fill_gradient(low = 'white',high='red')
colnames(A2) <- c("locate","id",paste0("week",1:52))
p <- ggplot() +
geom_polygon(data = merge_result,aes(x=long,y=lat,group=group,
fill = week1)) +
geom_text(data = korea, aes(x = long, y = lat, label = week))
p +
scale_fill_gradient(low = 'white',high='red')
J1 <- A2[,1:3]
View(J1)
str(J1)
getwd()
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1))
p +
scale_fill_gradient(low = 'white',high='orange')
View(merge_result)
merge_result <- merge(korea_map,A2,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1))
p +
scale_fill_gradient(low = 'white',high='orange')
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1))
p +
scale_fill_gradient(low = 'white',high='orange')
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2))
p +
scale_fill_gradient(low = 'white',high='orange')
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3))
p +
scale_fill_gradient(low = 'white',high='orange')
library(MASS)
install.packages("manipulate")
library(manipulate)
detach("package:manipulate", unload=TRUE)
library("leaflet", lib.loc="~/R/win-library/3.5")
library(shiny)
runApp('a')
for (i in 1:3) {
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = paste0("week",i))) +
scale_fill_gradient(low = 'white',high='orange')
}
for (i in 1:3) {
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = paste0("week",i))) +
scale_fill_gradient(low = 'white',high='orange')
p
}
for (i in 1:3) {
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = merge_result[,8+i])) +
scale_fill_gradient(low = 'white',high='orange')
p
}
p
View(p)
p
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea_map <- fortify(korea)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(raster)
library(rgeos)
library(maptools)
A1 <- read.csv("./doc/hong.csv")
A2[,2:ncol(A1)] <- t(apply(A1[,-1],1,function(x)cumsum(x)))
colnames(A2) <- c("locate","id",paste0("week",1:52))
A2$id <- c(0:6,8:16,7)
korea <- shapefile("data/TL_SCCO_CTPRVN.shp")
korea <- spTransform(korea,CRS("+proj=longlat"))
korea_map <- fortify(korea)
merge_result <- merge(korea_map,A2,by='id')
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1))
p +
scale_fill_gradient(low = 'white',high='orange')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(raster)
library(rgeos)
library(maptools)
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3)) +
scale_fill_gradient(low = 'white',high='orange')
p
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week4)) +
scale_fill_gradient(low = 'white',high='orange')
p
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week5)) +
scale_fill_gradient(low = 'white',high='orange')
p
p <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week6)) +
scale_fill_gradient(low = 'white',high='orange')
p
png("test.png",width=3.5,height=3.5,units="in",res=1200)
png("test1.png",width=3.5,height=3.5,units="in",res=1200)
p1
p1 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p1
p2 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p2
p1 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p1
p2 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p2
p3 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3)) +
scale_fill_gradient(low = 'white',high='orange')
p3
p4 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week4)) +
scale_fill_gradient(low = 'white',high='orange')
p4
p5 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week5)) +
scale_fill_gradient(low = 'white',high='orange')
p5
p6 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week6)) +
scale_fill_gradient(low = 'white',high='orange')
p6
png("test1.png",width=3.5,height=3.5,units="in",res=1200)
png("test2.png",width=3.5,height=3.5,units="in",res=1200)
png("test3.png",width=3.5,height=3.5,units="in",res=1200)
png("test4.png",width=3.5,height=3.5,units="in",res=1200)
png("test5.png",width=3.5,height=3.5,units="in",res=1200)
png("test1.png",width=3.5,height=3.5,units="in",res=1200)
p1
png("test1.png",width=3.5,height=3.5,units="in",res=1200)
p1
png("test1.png",width=3.5,height=3.5,units="in",res=1200)
p1
png("test1.png",units="in",res=1200)
p1 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p1
p2 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p2
p3 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3)) +
scale_fill_gradient(low = 'white',high='orange')
p3
p4 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week4)) +
scale_fill_gradient(low = 'white',high='orange')
p4
p5 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week5)) +
scale_fill_gradient(low = 'white',high='orange')
p5
p6 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week6)) +
scale_fill_gradient(low = 'white',high='orange')
p6
p1
p2
p3
p4
p5
p6
p1 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p1
p2 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p2
p3 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3)) +
scale_fill_gradient(low = 'white',high='orange')
p3
p4 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week4)) +
scale_fill_gradient(low = 'white',high='orange')
p4
p5 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week5)) +
scale_fill_gradient(low = 'white',high='orange')
p5
p6 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week6)) +
scale_fill_gradient(low = 'white',high='orange')
p6
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(raster)
library(rgeos)
library(maptools)
p1 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week1)) +
scale_fill_gradient(low = 'white',high='orange')
p1
p2 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week2)) +
scale_fill_gradient(low = 'white',high='orange')
p2
p3 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week3)) +
scale_fill_gradient(low = 'white',high='orange')
p3
p4 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week4)) +
scale_fill_gradient(low = 'white',high='orange')
p4
p5 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week5)) +
scale_fill_gradient(low = 'white',high='orange')
p5
p6 <- ggplot() +
geom_polygon(data = merge_result,
aes(x=long,y=lat,group=group, fill = week6)) +
scale_fill_gradient(low = 'white',high='orange')
p6
