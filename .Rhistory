mean(A3[A3$진료과목코드 == 4,16])
mean(A3[A3$진료과목코드 == 1,16])
mean(A3[A3$성별코드 == 1,16])
mean(A3[A3$성별코드 == 2,16])
mean(A3[A3$sub == 1,16])
mean(A3[A3$sub == 2,16])
mean(A3[A3$sub == 3,16])
mean(A3[A3$sub == 4,16])
mean(A3[A3$sub == 5,16])
mean(A3[A3$sub == ,16])
mean(A3[A3$sub == 6,16])
mean(A3[A3$sub == 7,16])
mean(A3[A3$sub == 0,16])
mean(A3[A3$진료과목코드 == 14,16])
mean(A3[A3$진료과목코드 == 14,14])
table(A3[A3$진료과목코드 == 14,14])
table(A3[A3$진료과목코드 == 4,14])
table(A3[A3$진료과목코드 == 7,14])
table(A3[A3$진료과목코드 == 23,14])
table(A3$심결가산율)
A3$심결가산율 <- factor(A3$심결가산율)
okfine <- lm(심결본인부담금~성별코드+연령대코드+진료과목코드+
심결가산율+입내원일수+sub,data = train)
summary(okfine)
str()
str(A3)
plot(okfine)
plot(okfine)
table(A3$심결가산율)
summary(okfine)
table(A3[A3$심결가산율 == ,14])
table(A3[A3$심결가산율 == 0,14])
table(A3[A3$심결가산율 == 0,16])
mean(A3[A3$심결가산율 == 0,16])
mean(A3[A3$심결가산율 == 15,16])
mean(A3[A3$심결가산율 == 25,16])
mean(A3[A3$심결가산율 == 20,16])
mean(A3[A3$심결가산율 == 30,16])
install.packages("moonBook")
table(A3$진료과목코드)
table(A2$진료과목코드)
require(moonBook)
install.packages("ggeffects")
library(ggeffects)
ggeffect(okfine)
install.packages("snakecase")
ggeffect(okfine)
okfine$model
colnames(okfine$model)
ggEffect=function(fit,x=1,probs=c(0.25,0.5,0.75),point=TRUE,xvalue=NULL){
df=fit$model
coef=fit$coef
name=colnames(df)
p<-ggplot(data=df,aes_string(x=name[1+x],y=name[1]))
if(is.null(xvalue)) A=quantile(df[[4-x]],probs,na.rm=TRUE)
else A=xvalue
labels=as.character(A)
intercept=coef[1]+coef[4-x]*A
slope=coef[1+x]+coef[4]*A
colour=rainbow(length(A))
df1=data.frame(A,intercept,slope,colour)
if(point) p<-p+geom_point()
p<-p+geom_abline(data=df1,aes(slope=slope,intercept=intercept,colour=colour))
p<-p+scale_colour_discrete(labels=labels)+labs(colour=name[4-x])
p
}
ggEffect(okfine)
library(ggplot2)
ggEffect(okfine)
require(ggplot2)
require(plyr)
require(reshape2)
require(ggiraph)
require(rgl)
require(ggiraphExtra)
require(moonBook
)
ggpredict(okfine)
P <- ggpredict(okfine)
P[1]
p(P[1])
plot(P[1])
ggpredict(okfine,interactive = T)
install.packages("ggiraphExtra")
library(ggiraphExtra)
P1[[1]]
P[[1]]
P
P$sub
View(P)
P[["성별코드"]]
ggplot(A3,aes(y=A3$부담심결본인부담금,x=A3$진료과목코드))+
geom_point()+
geom_smooth(method="lm")
ggplot(A3,aes(y=부담심결본인부담금,x=진료과목코드))+
geom_point()+
geom_smooth(method="lm")
ggplot(data = A3,aes(y=부담심결본인부담금,x=진료과목코드))+
geom_point()+
geom_smooth(method="lm")
ggplot(A3,aes(y=A3$부담심결본인부담금,x=A3$진료과목코드))+
geom_point()+
geom_smooth(method="lm")
str(A3)
ggplot(A3,aes(y=A3$부담심결본인부담금,x=A3$진료과목코드))+
geom_point()
attach(A3)
plot(진료과목코드~부담심결본인부담금)
plot(A3$진료과목코드~A3$부담심결본인부담금)
plot(A3$진료과목코드,A3$부담심결본인부담금)
plot(A3$진료과목코드,y=A3$부담심결본인부담금)
plot(x=A3$진료과목코드,y=A3$부담심결본인부담금)
plot(x=A3$진료과목코드,y=A3$부담심결본인부담금)
detach(A3)
ggplot(A3,aes(y=A3$부담심결본인부담금,x=A3$진료과목코드))+
geom_point()
ggplot()+
geom_point(A3,aes(x=진료과목코드,y=부담심결본인부담금))
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=부담심결본인부담금))
str(A3)
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=부담심결본인부담금))
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=심결본인부담금))
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "lm")
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "lm")
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "lm")
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14))
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
ylim(0,5000)
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
ylim(0,10000)
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14))
okfine
summary(okfine)
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14))
ggplot()+
geom_boxplot(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "glm")
ggplot()+
geom_point(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "glm")
ggplot()+
geom_point(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "glm")
ggplot()+
geom_point(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "lm")
ggplot()+
geom_point(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_raster(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_density2d(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_jitter(data = A3,aes(x=연령대코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_jitter(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_jitter(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm") +
ylim(0,5000)
ggplot()+
geom_jitter(data = A3,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm") +
ylim(0,10000)
ggplot()+
geom_jitter(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm") +
ylim(0,10000)
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm") +
ylim(0,10000)
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
stat_smooth(method = "lm")
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_smooth(method = "lm")
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금))
sum(okfine$coefficients)
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=128.164,slope= 8.718,
colour="green",linetype=2)
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=8.718,slope=128.164 ,
colour="green",linetype=2)
ok2 <- lm(심결본인부담금~연령대코드,data=train)
summary(ok2)
ok2
ggplot()+
geom_point(data = A3,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=1523.9,slope=365.6 ,
colour="green",linetype=2)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=1523.9,slope=365.6 ,
colour="green",linetype=2)
ok2 <- lm(심결본인부담금~연령대코드,data=A3)
ok2
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=1523.9,slope=454,
colour="green",linetype=2)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=1523.9,slope=1000,
colour="green",linetype=2)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=1523.9,slope=10000,
colour="green",linetype=2)
okfine
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=-20701,slope=15141,
colour="green",linetype=2)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=-20701,slope=15141,
colour="green",linetype=2,size=2)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=-20701,slope=15141,
colour="green",linetype=2,size=1.5)
ggplot()+
geom_point(data = train,aes(x=입내원일수,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=-20701,slope=15141,
colour="green",linetype=2,size=1)
okfine
15141
ggplot()+
geom_point(data = train,aes(x=진료과목코드,y=심결본인부담금)) +
scale_x_discrete(limits = c(4,11,23,1,14)) +
geom_abline(intercept=-20701,slope=15141,
colour="green",linetype=2,size=1)
okfine <- lm(심결본인부담금~연령대코드+진료과목코드+
심결가산율+입내원일수,data = train)
summary(okfine)
pred <- predict(okfine,newdata=test)
cor1 <- cor(pred,test$심결본인부담금,use="pairwise.complete.obs")
cor1 <- cor(pred,test$심결본인부담금,use="pairwise.complete.obs")
pred <- predict(okfine,newdata=test)
cor1 <- cor(pred,test$심결본인부담금,use="pairwise.complete.obs")
okfine <- lm(심결본인부담금~연령대코드+진료과목코드+
심결가산율+입내원일수,data = train)
summary(okfine)
train1 <- train[train$진료과목코드==14|
train$진료진료과목코드==23,]
okfine <- lm(심결본인부담금~연령대코드+진료과목코드+
심결가산율+입내원일수,data = train1)
str(train23)
str(train1)
View(train1)
View(train)
train1 <- train[train$진료과목코드==14|
train$진료진료과목코드==23,]
table(train$진료과목코드)
train1 <- train[train$진료과목코드==14,]
train1 <- train[train$진료과목코드==14|
train$진료진료과목코드==23,]
train1 <- train[train$진료과목코드==14|
train$진료과목코드==23,]
okfine <- lm(심결본인부담금~연령대코드+진료과목코드+
심결가산율+입내원일수,data = train1)
summary(okfine)
pred <- predict(okfine,newdata=test)
test1 <- test[test$진료과목코드==14|
test$진료과목코드==23,]
pred <- predict(okfine,newdata=test1)
cor1 <- cor(pred,test$심결본인부담금,use="pairwise.complete.obs")
cor(pred,test$심결본인부담금,use="pairwise.complete.obs")
cor(pred,test1$심결본인부담금,use="pairwise.complete.obs")
relweights <- function(fit,...){
R <- cor(fit$model)
nvar <- ncol(R)
rxx <- R[2:nvar, 2:nvar]
rxy <- R[2:nvar, 1]
svd <- eigen(rxx)
evec <- svd$vectors
ev <- svd$values
delta <- diag(sqrt(ev))
lambda <- evec %*% delta %*% t(evec)
lambdasq <- lambda ^ 2
beta <- solve(lambda) %*% rxy
rsquare <- colSums(beta ^ 2)
rawwgt <- lambdasq %*% beta ^ 2
import <- (rawwgt / rsquare) * 100
import <- as.data.frame(import)
row.names(import) <- names(fit$model[2:nvar])
names(import) <- "Weights"
import <- import[order(import),1, drop=FALSE]
dotchart(import$Weights, labels=row.names(import),
xlab="% of R-Square", pch=19,
main="Relative Importance of Predictor Variables",
sub=paste("Total R-Square=", round(rsquare, digits=3)),
...)
return(import)
}
relweights(okfine)
relweights(okfine)
okfine <- lm(연령대코드+진료과목코드+
심결가산율+입내원일수~심결본인부담금,data = train1)
okfine$model
plot(okfine)
attach(train)
plot(심결본인부담금~연령대코드)
abline
abline(okfine)
abline(okfine$model$연령대코드)
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
geom_smooth(method = "lm")
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
geom_smooth(aes(group=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
geom_smooth(aes(x=연령대코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,10000))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,10000)) +
geom_smooth(aes(group=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
geom_smooth(aes(group=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,10000))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,10000)) +
geom_smooth(aes(x=연령대코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,50000)) +
geom_smooth(aes(x=연령대코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,10000)) +
geom_smooth(aes(x=연령대코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=연령대코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,100000)) +
geom_smooth(aes(x=연령대코드,y=심결본인부담금))
geom_point(aes(x=진료과목코드,y=심결본인부담금),data = train)+
ggplot()+
geom_point(aes(x=진료과목코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,100000)) +
geom_smooth(aes(x=진료과목코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=진료과목코드,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,100000)) +
geom_smooth(aes(x=진료과목코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=진료과목코드,y=심결본인부담금),data = train)
ggplot()+
geom_point(aes(x=진료과목코드,y=심결본인부담금),data = train) +
geom_smooth(aes(x=진료과목코드,y=심결본인부담금))
geom_point(aes(x=심결가산ㅇ,y=심결본인부담금),data = train)+
12
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train)+
coord_cartesian(ylim = c(0,100000)) +
geom_smooth(aes(x=심결가산율,y=심결본인부담금))
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
geom_smooth(aes(x=심결가산율,y=심결본인부담금),data = train)
str(train)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
geom_smooth(aes(x=심결가산율,y=심결본인부담금))
okfine
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
geom_abline(intercept = -30000, slope = 1124.16 ,
col = "blue", lty = 2,size=1)
okfine <- lm(심결본인부담금~연령대코드+진료과목코드+
심결가산율+입내원일수,data = train)
okfine
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
geom_abline(intercept = -20776, slope = 499.56 ,
col = "blue", lty = 2,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000)) +
geom_abline(intercept = -20776, slope = 499.56 ,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = -20776, slope = 499.56 ,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(aes(x=연령대코드,y=심결본인부담금))
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(aes(x=심결가산율,y=심결본인부담금))
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_smooth(aes(x=심결가산율,y=심결본인부담금))
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = -20776, slope = 15000 ,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = 0, slope =  499.56,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = 5000, slope =  499.56,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_point(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = 3000, slope =  499.56,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_jitter(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,100000),
xlim = c(10,35)) +
geom_abline(intercept = 3000, slope =  499.56,
col = "blue",lty = 2 ,size=1)
ggplot()+
geom_jitter(aes(x=심결가산율,y=심결본인부담금),data = train) +
coord_cartesian(ylim = c(0,75000),
xlim = c(10,35)) +
geom_abline(intercept = 3000, slope =  499.56,
col = "blue",lty = 2 ,size=1)
